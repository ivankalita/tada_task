!function c(s,o,l){function i(t,e){if(!o[t]){if(!s[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var r=o[t]={exports:{}};s[t][0].call(r.exports,function(e){return i(s[t][1][e]||e)},r,r.exports,c,s,o,l)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)i(l[e]);return i}({1:[function(e,t,a){t.exports={face:{eyes:["eyes1","eyes10","eyes2","eyes3","eyes4","eyes5","eyes6","eyes7","eyes9"],nose:["nose2","nose3","nose4","nose5","nose6","nose7","nose8","nose9"],mouth:["mouth1","mouth10","mouth11","mouth3","mouth5","mouth6","mouth7","mouth9"],colors:[{slug:"red",value:"F04747"},{slug:"blue",value:"7289DA"},{slug:"green",value:"43B581"},{slug:"purple",value:"904FAD"},{slug:"yellow",value:"FAA61A"},{slug:"cyan",value:"00BCD4"},{slug:"lime",value:"CDDC39"},{slug:"brown",value:"795548"}]}}},{}],2:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=function(e){var n=e.box||document.getElementById("msg-box"),t=e.host||"pm.tada.team",r=e.user||"test123",c=e.userAva||"https://api.adorable.io/avatars/face/eyes1/nose2/mouth1/F04747/50",s=e.name||"Tada.team",o=e.el,l=new WebSocket("ws://".concat(t,"/ws?name=").concat(r)),i=[];function a(){var a,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];o.querySelector(".chat-header__title .user-name").textContent=r,o.querySelector(".chat-header__title .chat-name").textContent=s,o.querySelector(".chat-footer__ava .image").src=c,a=e,l.onmessage=function(e){var t=JSON.parse(e.data);console.log(t),i.push(t),localStorage.setItem("chatHistory",JSON.stringify(i)),!0!==t.typing&&m(void 0!==t.name?t.name===r?u(!0,t.name,t.text,t.created):u(!1,t.name,t.text,t.created):a?d(!0,a,t.created):d(!1,t.text,t.created))},localStorage.setItem("chatUserName",r),localStorage.setItem("chatUserAva",c),localStorage.setItem("chatName",s),t?(i=JSON.parse(localStorage.getItem("chatHistory"))).forEach(function(e){m(void 0!==e.name?e.name===r?u(!0,e.name,e.text,e.created):u(!1,e.name,e.text,e.created):d(!1,e.text,e.created))}):n.innerHTML=""}function u(e,t,a,n){var r=new Date(n);return'\n        <li class="list-msg__item">\n            <div class="ava">\n                <img src="'.concat(e?c:"https://api.adorable.io/avatars/50/random",'" class="image">\n            </div>\n            <div class="msg">\n                <div class="msg-sender">').concat(t,'</div>\n                <div class="msg-cnt">').concat(a,'</div>\n            </div>\n            <div class="date">').concat(r.getDate(),".").concat(r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,".").concat(r.getFullYear(),"</div>\n        </li>")}function d(e,t,a){var n=new Date(a);return e?'\n            <li class="list-msg__item list-msg__item--system">\n                <span>@'.concat(t.oldName," переименовался в ").concat(t.newName,"</span>\n            </li>"):'\n            <li class="list-msg__item list-msg__item--system">\n                <span>к чату присоединился @'.concat(t.slice(8),", ").concat(n.getHours(),":").concat(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes(),"</span>\n            </li>")}function m(e){n.innerHTML+=e}this.getHostName=function(){return t},this.getUserName=function(){return r},this.getChatName=function(){return s},this.init=a,this.sendMessage=function(e){console.log(e),l.send(JSON.stringify({text:e}))},this.setUserName=function(e){e&&(l.close(1e3,"".concat(r," changed name to ").concat(e)),l=new WebSocket("ws://".concat(t,"/ws?name=").concat(e)),a({oldName:r,newName:e}),r=e,o.querySelector(".chat-header__title .user-name").textContent=r,localStorage.setItem("chatUserName",r))},this.setChatName=function(e){s=e,window.document.title=s,localStorage.setItem("chatName",s)},this.exit=function(){l.close(1e3,"".concat(r," покинул чат")),localStorage.removeItem("chatUserName"),localStorage.removeItem("chatUserAva"),localStorage.removeItem("chatName"),localStorage.removeItem("chatHistory")}};a.default=n},{}],3:[function(e,t,a){"use strict";var f=n(e("./Chat")),y=n(e("../faces.json"));function n(e){return e&&e.__esModule?e:{default:e}}!function(){var r=document.getElementById("lobby-one"),c=r.querySelector(".lobby-card--name"),s=r.querySelector(".lobby-card--ava"),t=document.getElementById("ava-image"),o=document.getElementById("chat-one"),a=document.getElementById("sndBtn"),l=o.querySelector(".chat-header"),e=o.querySelector(".chat-footer"),n=document.getElementById("input-msg"),i=null,u="test123";localStorage.getItem("chatUserName")&&((i=new f.default({user:localStorage.getItem("chatUserName"),userAva:localStorage.getItem("chatUserAva"),name:localStorage.getItem("chatName"),box:o.querySelector(".list-msg"),el:document.getElementById("chat-one")})).init(null,!0),r.classList.remove("show"),c.classList.remove("current"),o.classList.add("show")),window.addEventListener("beforeunload",function(e){if(i){var t=new Date;i.sendMessage("".concat(localStorage.getItem("chatUserName")," покинул чат, ").concat(t.getHours(),":").concat(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()))}}),c.querySelector("[lobby-next]").addEventListener("click",function(){0===c.querySelector(".inp").value.trim().length||c.querySelector(".inp").value.trim().match(/[^a-zA-Z0-9а-яА-Я_]+/g)?(c.querySelector(".inp").value.trim().match(/[^a-zA-Z0-9а-яА-Я_]+/g)?c.querySelector(".inp-error").textContent="Только буквы, цифры и _":c.querySelector(".inp-error").textContent="Нельзя оставить пустым",c.querySelector(".inp-error").classList.add("show")):(u=c.querySelector(".inp").value.trim(),c.querySelector(".inp-error").classList.remove("show"),c.classList.remove("current"),s.classList.add("current"))}),c.querySelector(".inp").addEventListener("input",function(e){20<e.target.value.trim().length?(e.target.value=u,c.querySelector(".inp-error").textContent="Не более 20 символов",c.querySelector(".inp-error").classList.add("show")):e.data&&e.data.match(/^[^a-zA-Z0-9а-яА-Я_]+$/g)?(c.querySelector(".inp-error").textContent="Только буквы, цифры и _",c.querySelector(".inp-error").classList.add("show")):(u=e.target.value,c.querySelector(".inp-error").classList.remove("show"))}),s.addEventListener("click",function(e){e.target==s.querySelector("[lobby-prev]")?(s.classList.remove("current"),c.classList.add("current")):e.target==s.querySelector("[lobby-accept]")&&((i=new f.default({user:u,userAva:t.src.replace("/100","/50"),box:o.querySelector(".list-msg"),el:document.getElementById("chat-one")})).init(),s.classList.add("done"),o.classList.add("show"),r.classList.remove("show"))});var d=0,m=0,h=0,g=0;function v(){t.src="https://api.adorable.io/avatars/face/".concat(y.default.face.eyes[d],"/").concat(y.default.face.nose[m],"/").concat(y.default.face.mouth[h],"/").concat(y.default.face.colors[g].value,"/100")}s.querySelectorAll(".ava-creator .item").forEach(function(e){e.addEventListener("click",function(e){this.parentElement.classList.contains("ava-creator__prev")&&("eyes"===this.dataset.cntrl&&0!==d&&d--,"nose"===this.dataset.cntrl&&0!==m&&m--,"mouth"===this.dataset.cntrl&&0!==h&&h--,v()),this.parentElement.classList.contains("ava-creator__next")&&("eyes"===this.dataset.cntrl&&d<y.default.face.eyes.length-1&&d++,"nose"===this.dataset.cntrl&&m<y.default.face.nose.length-1&&m++,"mouth"===this.dataset.cntrl&&h<y.default.face.mouth.length-1&&h++,v())})}),s.querySelectorAll(".clr-picker__item").forEach(function(e){e.addEventListener("click",function(e){var a=this;this.classList.contains("selected")||(Array.from(this.parentElement.children).forEach(function(e){return!!e.classList.contains("selected")&&e.classList.remove("selected")}),this.classList.add("selected"),y.default.face.colors.forEach(function(e,t){return e.slug===a.dataset.clr&&(g=t)}),v())})}),l.addEventListener("click",function(a){if(a.target.classList.contains("menu-list__item"))if("changeUserName"===a.target.dataset.action){var e=l.querySelector(".chat-header__title .user-name");l.querySelector(".chat-header__settings .cbx").checked=!1,e.setAttribute("contenteditable","true"),e.focus(),e.classList.add("active"),e.addEventListener("keydown",n)}else if("changeChatName"===a.target.dataset.action){var t=l.querySelector(".chat-header__title .chat-name");l.querySelector(".chat-header__settings .cbx").checked=!1,t.setAttribute("contenteditable","true"),t.focus(),t.classList.add("active"),t.addEventListener("keydown",n)}else"exit"===a.target.dataset.action&&(i.exit(),l.querySelector(".chat-header__settings .cbx").checked=!1,o.classList.remove("show"),r.classList.add("show"),c.classList.add("current"),s.classList.remove("current","done"));function n(e){var t=null;"changeUserName"===a.target.dataset.action?t=l.querySelector(".chat-header__title .user-name"):"changeChatName"===a.target.dataset.action&&(t=l.querySelector(".chat-header__title .chat-name")),"Enter"===e.key&&(e.preventDefault(),t.blur(),t.removeAttribute("contenteditable"),t.classList.remove("active"),"changeUserName"===a.target.dataset.action?i.setUserName(t.textContent):"changeChatName"===a.target.dataset.action&&i.setChatName(t.textContent)),1===e.key.length&&(97<=e.key.charCodeAt()&&e.key.charCodeAt()<=122||65<=e.key.charCodeAt()&&e.key.charCodeAt()<=90||48<=e.key.charCodeAt()&&e.key.charCodeAt()<=57||1040<=e.key.charCodeAt()&&e.key.charCodeAt()<=1103||95===e.key.charCodeAt())&&19<t.textContent.length&&e.preventDefault()}}),e.addEventListener("click",function(e){e.target==n?n.classList.add("active"):e.target==a&&""!==n.value.trim()&&(console.dir(n),i.sendMessage(n.value.trim()),n.classList.remove("active"),n.blur(),n.value="")})}()},{"../faces.json":1,"./Chat":2}]},{},[3]);